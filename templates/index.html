<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Orbit Control</title>
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
    <style>
        :root {
            --bg: #0d1117; --card: #161b22; --border: #30363d;
            --accent: #58a6ff; --error: #f85149; --success: #3fb950;
            --warning: #d29922; --text: #c9d1d9;
        }
        * { box-sizing: border-box; }
        body {
            background-color: var(--bg); color: var(--text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            padding: 0; margin: 0; line-height: 1.5;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ============ SPACE BACKGROUND ============ */
        .space-bg {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
            overflow: hidden;
            background: radial-gradient(ellipse at bottom, #1a1a2e 0%, #0d1117 100%);
        }

        .stars {
            position: absolute;
            width: 100%; height: 100%;
            background-image:
                radial-gradient(2px 2px at 20px 30px, #eee, transparent),
                radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
                radial-gradient(1px 1px at 90px 40px, #fff, transparent),
                radial-gradient(2px 2px at 160px 120px, rgba(255,255,255,0.9), transparent),
                radial-gradient(1px 1px at 230px 80px, #fff, transparent),
                radial-gradient(2px 2px at 300px 150px, rgba(255,255,255,0.7), transparent),
                radial-gradient(1px 1px at 370px 200px, #fff, transparent),
                radial-gradient(2px 2px at 450px 50px, rgba(255,255,255,0.8), transparent);
            background-size: 500px 300px;
            animation: twinkle 5s ease-in-out infinite;
        }

        .stars2 {
            position: absolute;
            width: 100%; height: 100%;
            background-image:
                radial-gradient(1px 1px at 50px 100px, #fff, transparent),
                radial-gradient(2px 2px at 100px 200px, rgba(255,255,255,0.6), transparent),
                radial-gradient(1px 1px at 200px 50px, #fff, transparent),
                radial-gradient(1px 1px at 280px 180px, rgba(255,255,255,0.8), transparent),
                radial-gradient(2px 2px at 400px 100px, #fff, transparent),
                radial-gradient(1px 1px at 480px 250px, rgba(255,255,255,0.7), transparent);
            background-size: 550px 350px;
            animation: twinkle 7s ease-in-out infinite reverse;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Planets */
        .planet {
            position: absolute;
            border-radius: 50%;
        }

        .planet1 {
            width: 80px; height: 80px;
            background: radial-gradient(circle at 30% 30%, #58a6ff, #1a4b8c);
            top: 15%; right: 10%;
            box-shadow: 0 0 40px rgba(88, 166, 255, 0.3);
            animation: float 20s ease-in-out infinite;
        }

        .planet2 {
            width: 40px; height: 40px;
            background: radial-gradient(circle at 30% 30%, #f85149, #8b2020);
            top: 60%; right: 5%;
            box-shadow: 0 0 20px rgba(248, 81, 73, 0.3);
            animation: float 15s ease-in-out infinite reverse;
        }

        .planet3 {
            width: 25px; height: 25px;
            background: radial-gradient(circle at 30% 30%, #3fb950, #1a5c28);
            top: 40%; left: 5%;
            box-shadow: 0 0 15px rgba(63, 185, 80, 0.3);
            animation: float 25s ease-in-out infinite;
        }

        /* Orbit rings */
        .orbit-ring {
            position: absolute;
            border: 1px solid rgba(88, 166, 255, 0.1);
            border-radius: 50%;
            animation: rotate 60s linear infinite;
        }

        .orbit1 {
            width: 300px; height: 300px;
            top: 10%; right: -50px;
        }

        .orbit2 {
            width: 200px; height: 200px;
            bottom: 20%; left: -30px;
            animation-duration: 45s;
            animation-direction: reverse;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ============ UPDATE BANNER ============ */
        .update-banner {
            display: none;
            background: linear-gradient(90deg, #238636, #2ea043);
            color: white;
            padding: 12px 20px;
            text-align: center;
            font-size: 0.85rem;
        }
        .update-banner.visible { display: block; }
        .update-banner a {
            color: white;
            font-weight: 600;
            margin-left: 10px;
            text-decoration: underline;
        }
        .update-banner a:hover { opacity: 0.9; }

        /* GitHub Banner */
        .github-banner {
            background: rgba(88, 166, 255, 0.1);
            border-bottom: 1px solid var(--border);
            padding: 8px 20px;
            text-align: center;
            font-size: 0.8rem;
        }
        .github-banner a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 500;
        }
        .github-banner a:hover { text-decoration: underline; }

        .main-content { padding: 30px; position: relative; z-index: 1; }

        .header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 30px; border-bottom: 1px solid var(--border); padding-bottom: 20px;
        }
        h1 { font-size: 1.5rem; font-weight: 400; margin: 0; }
        h1 b { color: var(--accent); }

        .tabs { display: grid; grid-template-columns: repeat(5, 1fr); gap: 15px; }
        .tab {
            background: rgba(22, 27, 34, 0.9); border: 1px solid var(--border); border-radius: 6px;
            padding: 20px; cursor: pointer; transition: all 0.2s;
            backdrop-filter: blur(10px);
        }
        .tab:hover { border-color: #8b949e; }
        .tab.active { border-color: var(--accent); background: rgba(33, 38, 45, 0.9); }
        .tab.disabled { opacity: 0.5; cursor: not-allowed; }
        .tab.disabled:hover { border-color: var(--border); }
        .tab-label { font-size: 0.7rem; color: #8b949e; text-transform: uppercase; }
        .count { display: block; font-size: 1.8rem; font-weight: 600; margin-top: 5px; }

        #details-section {
            margin-top: 25px; background: rgba(22, 27, 34, 0.95); border: 1px solid var(--border);
            border-radius: 6px; display: none; overflow: hidden;
            backdrop-filter: blur(10px);
        }
        #details-section.visible { display: block; }

        .section-header {
            padding: 15px 20px; background: rgba(33, 38, 45, 0.9); border-bottom: 1px solid var(--border);
            display: flex; justify-content: space-between; align-items: center;
        }
        .section-title { font-size: 0.9rem; font-weight: 600; color: #f0f6fc; }

        .btn {
            background: var(--accent); color: #0d1117; border: none;
            padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.8rem; font-weight: 600;
        }
        .btn:hover { opacity: 0.8; }
        .btn-secondary { background: transparent; color: var(--accent); border: 1px solid var(--accent); }

        .list-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 20px; border-bottom: 1px solid var(--border);
        }
        .list-item:last-child { border-bottom: none; }
        .list-item:hover { background: rgba(33, 38, 45, 0.5); }

        .info { display: flex; align-items: center; gap: 12px; }
        .dot { width: 8px; height: 8px; border-radius: 50%; }
        .dot.running { background: var(--success); box-shadow: 0 0 5px var(--success); }
        .dot.stopped, .dot.exited { background: var(--error); }
        .dot.paused, .dot.restarting { background: var(--warning); }
        .dot.restarting { animation: pulse 1s infinite; }
        .dot.default { background: var(--accent); }

        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.4; } }

        .item-name { font-weight: 500; }
        .item-details { font-family: monospace; font-size: 0.75rem; color: #8b949e; }
        .item-meta { display: flex; align-items: center; gap: 10px; }
        .item-id { font-family: monospace; font-size: 0.7rem; color: #6e7681; }

        .actions { display: flex; gap: 5px; }
        .action-btn {
            background: transparent; border: 1px solid var(--border); color: var(--text);
            padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 0.7rem;
        }
        .action-btn:hover { background: #21262d; }
        .action-btn.start { color: var(--success); border-color: var(--success); }
        .action-btn.stop { color: var(--warning); border-color: var(--warning); }
        .action-btn.restart { color: var(--accent); border-color: var(--accent); }
        .action-btn.remove { color: var(--error); border-color: var(--error); }
        .action-btn.logs { color: #a371f7; border-color: #a371f7; }

        button.logout {
            background: transparent; color: var(--error); border: 1px solid var(--border);
            padding: 6px 15px; border-radius: 6px; cursor: pointer; font-size: 0.8rem;
        }

        .empty-state { padding: 40px; text-align: center; color: #6e7681; }

        /* Stack status */
        .stack-containers {
            display: flex; gap: 4px; margin-top: 5px;
        }
        .stack-dot {
            width: 6px; height: 6px; border-radius: 50%;
        }

        /* Modal */
        .modal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); justify-content: center; align-items: center; z-index: 1000;
        }
        .modal.visible { display: flex; }
        .modal-content {
            background: var(--card); border: 1px solid var(--border); border-radius: 8px;
            padding: 25px; width: 450px; max-height: 80vh; overflow-y: auto;
        }
        .modal-content.wide { width: 700px; }
        .modal-title { font-size: 1.1rem; font-weight: 600; margin-bottom: 20px; }

        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 0.8rem; color: #8b949e; margin-bottom: 5px; }
        .form-group input, .form-group select, .form-group textarea {
            width: 100%; padding: 10px; background: var(--bg);
            border: 1px solid var(--border); color: var(--text); border-radius: 4px;
        }
        .form-group textarea {
            font-family: monospace; font-size: 0.85rem; min-height: 200px; resize: vertical;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none; border-color: var(--accent);
        }
        .form-group small { color: #6e7681; font-size: 0.7rem; }

        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }

        .modal-buttons { display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px; }

        /* Logs modal */
        .logs-container {
            background: #000;
            border: 1px solid var(--border);
            border-radius: 4px;
            padding: 15px;
            font-family: monospace;
            font-size: 0.75rem;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-all;
            color: #0f0;
        }

        /* Toast */
        .toast {
            position: fixed; bottom: 20px; right: 20px; padding: 12px 20px;
            background: var(--card); border: 1px solid var(--border); border-radius: 6px;
            display: none; z-index: 1001; max-width: 350px;
        }
        .toast.visible { display: block; animation: slideIn 0.3s ease; }
        .toast.success { border-color: var(--success); }
        .toast.error { border-color: var(--error); }
        @keyframes slideIn { from { transform: translateX(100%); } to { transform: translateX(0); } }
    </style>
</head>
<body>

    <!-- SPACE BACKGROUND -->
    <div class="space-bg">
        <div class="stars"></div>
        <div class="stars2"></div>
        <div class="planet planet1"></div>
        <div class="planet planet2"></div>
        <div class="planet planet3"></div>
        <div class="orbit-ring orbit1"></div>
        <div class="orbit-ring orbit2"></div>
    </div>

    <!-- UPDATE BANNER -->
    <div class="update-banner" id="update-banner">
        üéâ Nowa wersja dostƒôpna!
        <a href="https://github.com/TobiMessi/orbit/releases/latest" target="_blank">Pobierz teraz ‚Üí</a>
    </div>

    <!-- GITHUB BANNER -->
    <div class="github-banner">
        ‚≠ê Sprawd≈∫ projekt na GitHub: <a href="https://github.com/TobiMessi/orbit" target="_blank">TobiMessi/orbit</a>
    </div>

    <div class="main-content">
        <div class="header">
            <h1>Orbit <b>Control</b></h1>
            <button class="logout" onclick="logout()">Logout</button>
        </div>

        <div class="tabs">
            <div class="tab" data-type="containers">
                <span class="tab-label">Containers</span>
                <span class="count" id="count-containers">0</span>
            </div>
            <div class="tab" data-type="images">
                <span class="tab-label">Images</span>
                <span class="count" id="count-images">0</span>
            </div>
            <div class="tab" data-type="volumes">
                <span class="tab-label">Volumes</span>
                <span class="count" id="count-volumes">0</span>
            </div>
            <div class="tab" data-type="networks">
                <span class="tab-label">Networks</span>
                <span class="count" id="count-networks">0</span>
            </div>
            <div class="tab" data-type="stacks">
                <span class="tab-label">Stacks</span>
                <span class="count" id="count-stacks">0</span>
            </div>
        </div>

        <div id="details-section">
            <div class="section-header">
                <span class="section-title" id="details-header">Lista</span>
                <button class="btn" id="btn-add" style="display:none;" onclick="openCreateModal()">+ Dodaj</button>
            </div>
            <div id="details-list"></div>
        </div>
    </div>

    <!-- Modal tworzenia kontenera -->
    <div class="modal" id="container-modal">
        <div class="modal-content">
            <div class="modal-title">üê≥ Utw√≥rz kontener</div>

            <div class="form-group">
                <label>Obraz *</label>
                <input type="text" id="c-image" placeholder="np. nginx:latest, postgres:15">
                <small>Obraz zostanie pobrany automatycznie je≈õli nie istnieje</small>
            </div>

            <div class="form-group">
                <label>Nazwa kontenera</label>
                <input type="text" id="c-name" placeholder="np. my-nginx (opcjonalne)">
            </div>

            <div class="form-group">
                <label>Porty</label>
                <div class="form-row">
                    <input type="text" id="c-port-host" placeholder="Port hosta (np. 8080)">
                    <input type="text" id="c-port-container" placeholder="Port kontenera (np. 80)">
                </div>
                <small>Mapowanie: host:kontener</small>
            </div>

            <div class="form-group">
                <label>Zmienne ≈õrodowiskowe</label>
                <input type="text" id="c-env" placeholder="KEY=value, DB_HOST=localhost">
                <small>Oddzielone przecinkami</small>
            </div>

            <div class="form-group">
                <label>Restart Policy</label>
                <select id="c-restart">
                    <option value="no">No (nie restartuj)</option>
                    <option value="always">Always (zawsze)</option>
                    <option value="on-failure">On Failure (przy b≈Çƒôdzie)</option>
                    <option value="unless-stopped">Unless Stopped</option>
                </select>
            </div>

            <div class="form-group">
                <label>Sieƒá</label>
                <select id="c-network">
                    <option value="">Domy≈õlna (bridge)</option>
                </select>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('container-modal')">Anuluj</button>
                <button class="btn" onclick="createContainer()">Utw√≥rz</button>
            </div>
        </div>
    </div>

    <!-- Modal tworzenia sieci/volume -->
    <div class="modal" id="simple-modal">
        <div class="modal-content">
            <div class="modal-title" id="simple-modal-title">Utw√≥rz</div>

            <div class="form-group">
                <label>Nazwa *</label>
                <input type="text" id="simple-name" placeholder="Nazwa">
            </div>

            <div class="form-group" id="driver-group" style="display:none;">
                <label>Driver</label>
                <select id="simple-driver">
                    <option value="bridge">bridge</option>
                    <option value="host">host</option>
                    <option value="overlay">overlay</option>
                    <option value="macvlan">macvlan</option>
                </select>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('simple-modal')">Anuluj</button>
                <button class="btn" onclick="confirmSimpleCreate()">Utw√≥rz</button>
            </div>
        </div>
    </div>

    <!-- Modal pull image -->
    <div class="modal" id="pull-modal">
        <div class="modal-content">
            <div class="modal-title">üì• Pobierz obraz</div>

            <div class="form-group">
                <label>Nazwa obrazu *</label>
                <input type="text" id="pull-image" placeholder="np. nginx:latest, redis:7-alpine">
            </div>

            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('pull-modal')">Anuluj</button>
                <button class="btn" onclick="pullImage()">Pobierz</button>
            </div>
        </div>
    </div>

    <!-- Modal tworzenia stacka -->
    <div class="modal" id="stack-modal">
        <div class="modal-content wide">
            <div class="modal-title">üì¶ Utw√≥rz Stack (Docker Compose)</div>

            <div class="form-group">
                <label>Nazwa stacka *</label>
                <input type="text" id="stack-name" placeholder="np. my-app">
            </div>

            <div class="form-group">
                <label>Docker Compose (YAML) *</label>
                <textarea id="stack-compose" placeholder="version: '3'
services:
  web:
    image: nginx:latest
    ports:
      - '8080:80'"></textarea>
            </div>

            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('stack-modal')">Anuluj</button>
                <button class="btn" onclick="createStack()">Uruchom Stack</button>
            </div>
        </div>
    </div>

    <!-- Modal log√≥w -->
    <div class="modal" id="logs-modal">
        <div class="modal-content wide">
            <div class="modal-title" id="logs-title">üìã Logi kontenera</div>
            <div class="logs-container" id="logs-content">≈Åadowanie...</div>
            <div class="modal-buttons">
                <button class="btn btn-secondary" onclick="closeModal('logs-modal')">Zamknij</button>
                <button class="btn" onclick="refreshLogs()">üîÑ Od≈õwie≈º</button>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast"></div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>
</html>